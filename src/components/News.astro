---
import { Image } from "astro:assets";
import news from "@/data/news.json";
import { mapGlobToImages } from "@/utils/imageMap";
import SectionHeader from "@/components/SectionHeader.astro";

const coverModules = import.meta.glob("../images/news/*", { eager: true });
const coverByName = mapGlobToImages(coverModules);

const newsItems = news.map((item) => {
  const name = item.cover.split("/").pop() ?? item.cover;
  return {
    ...item,
    coverImage: coverByName[name] ?? item.cover,
  };
});
---

<section class="news">
  <SectionHeader title="お知らせ" subtitle="news" />
  <ul class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 my-12 space-y-4">
    {newsItems.map((item) => (
      <li class="flex items-center gap-4 border border-gray-200 rounded-md p-4">
        <div class="">
          <Image
              src={item.coverImage}
              alt={`${item.title} cover`}
              class="w-40 h-40 object-cover"
              width={220}
              height={140}
              loading="lazy"
            />
        </div>
        <div class="space-y-2">
          <h3 class="text-lg font-bold text-sky-900">{item.title}</h3>
          <p class="text-sm text-gray-500">{item.date}</p>
        </div>
      </li>
    ))}
  </ul>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <span class="uppercase text-3xl text-sky-900 border-b border-sky-900">
    view all
  </span>
  </div>
</section>